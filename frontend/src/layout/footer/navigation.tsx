"use client";

import BasketSidebar from "@/src/modules/basket/components/sidebar";
import classNames from "classnames";
import Link from "next/link";
import { usePathname } from "next/navigation";
import React from "react";

interface FooterNav {
  name: string;
  href: string;
  icon: (isActive: boolean) => React.JSX.Element;
  routes: string[];
}

const routes: FooterNav[] = [
  {
    name: "Главная",
    href: "/",
    icon: (isActive: boolean) => <HomeIcon isActive={isActive} />,
    routes: ["/"],
  },
  {
    name: "Каталог",
    href: "/catalog",
    icon: (isActive: boolean) => <CatalogIcon isActive={isActive} />,
    routes: ["/catalog", "/products"],
  },
  {
    name: "Поиск",
    href: "/search",
    icon: (isActive: boolean) => <SearchIcon isActive={isActive} />,
    routes: ["/search"],
  },
  {
    name: "Избранное",
    href: "/favorites",
    icon: (isActive: boolean) => <FavoritesIcon isActive={isActive} />,
    routes: ["/favorites"],
  },
  {
    name: "Корзина",
    href: "",
    icon: () => <BasketIcon />,
    routes: [""],
  },
];

function FooterMobileNavigation() {
  return (
    <nav className="bg-white border-t border-stroke shadow">
      <div className="container">
        <ul className="flex justify-between items-center">
          {routes.map((item) => (
            <NavItem key={item.name} {...item} />
          ))}
        </ul>
      </div>
    </nav>
  );
}

function NavItem(item: FooterNav) {
  const pathname = usePathname();
  const isActive = item.routes.includes("/" + pathname.split("/")[1]);

  return (
    <li>
      <Link
        href={item.href}
        key={item.name}
        className="flex flex-col items-center gap-1 pb-1.5 pt-3.5 relative"
      >
        {isActive && (
          <div className="absolute top-0">
            <svg
              width="24"
              height="8"
              viewBox="0 0 24 8"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M17.5999 5.36059C14.466 8.47513 9.40061 8.45939 6.28612 5.32543L0 -1L11.9254 -1L24 -1L17.5999 5.36059Z"
                fill="#2CA89A"
              />
            </svg>
          </div>
        )}
        <div>{item.icon(isActive)}</div>
        <div
          className={classNames("text-xs text-center", isActive && "text-main")}
        >
          {item.name}
        </div>
      </Link>
    </li>
  );
}

function HomeIcon({ isActive }: { isActive: boolean }) {
  return (
    <svg
      width="24"
      height="19"
      viewBox="0 0 24 19"
      xmlns="http://www.w3.org/2000/svg"
      className={classNames(isActive ? "fill-main" : "fill-text")}
    >
      <path d="M22.5 17.5H21V8.83281C21 8.62521 20.957 8.41986 20.8735 8.22976C20.7901 8.03966 20.6681 7.86895 20.5153 7.72843L13.0153 0.65218C13.0116 0.648981 13.0082 0.645536 13.005 0.641867C12.7289 0.390742 12.369 0.251587 11.9958 0.251587C11.6225 0.251587 11.2627 0.390742 10.9866 0.641867L10.9762 0.65218L3.48469 7.72843C3.33187 7.86895 3.20989 8.03966 3.12646 8.22976C3.04303 8.41986 2.99997 8.62521 3 8.83281V17.5H1.5C1.30109 17.5 1.11032 17.579 0.96967 17.7197C0.829018 17.8603 0.75 18.0511 0.75 18.25C0.75 18.4489 0.829018 18.6397 0.96967 18.7803C1.11032 18.921 1.30109 19 1.5 19H22.5C22.6989 19 22.8897 18.921 23.0303 18.7803C23.171 18.6397 23.25 18.4489 23.25 18.25C23.25 18.0511 23.171 17.8603 23.0303 17.7197C22.8897 17.579 22.6989 17.5 22.5 17.5ZM4.5 8.83281L4.51031 8.82343L12 1.74999L19.4906 8.82156L19.5009 8.83093V17.5H15V13C15 12.6022 14.842 12.2206 14.5607 11.9393C14.2794 11.658 13.8978 11.5 13.5 11.5H10.5C10.1022 11.5 9.72064 11.658 9.43934 11.9393C9.15804 12.2206 9 12.6022 9 13V17.5H4.5V8.83281ZM13.5 17.5H10.5V13H13.5V17.5Z" />
    </svg>
  );
}

function CatalogIcon({ isActive }: { isActive: boolean }) {
  return (
    <svg
      width="20"
      height="20"
      viewBox="0 0 20 20"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      className={classNames(isActive ? "stroke-main" : "stroke-text")}
    >
      <g clipPath="url(#clip0_407_6412)">
        <path
          d="M4.16699 8.33329H5.83366C7.50032 8.33329 8.33366 7.49996 8.33366 5.83329V4.16663C8.33366 2.49996 7.50032 1.66663 5.83366 1.66663H4.16699C2.50033 1.66663 1.66699 2.49996 1.66699 4.16663V5.83329C1.66699 7.49996 2.50033 8.33329 4.16699 8.33329Z"
          strokeWidth="1.5"
          strokeMiterlimit="10"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
        <path
          d="M14.167 8.33329H15.8337C17.5003 8.33329 18.3337 7.49996 18.3337 5.83329V4.16663C18.3337 2.49996 17.5003 1.66663 15.8337 1.66663H14.167C12.5003 1.66663 11.667 2.49996 11.667 4.16663V5.83329C11.667 7.49996 12.5003 8.33329 14.167 8.33329Z"
          strokeWidth="1.5"
          strokeMiterlimit="10"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
        <path
          d="M14.167 18.3333H15.8337C17.5003 18.3333 18.3337 17.5 18.3337 15.8333V14.1666C18.3337 12.5 17.5003 11.6666 15.8337 11.6666H14.167C12.5003 11.6666 11.667 12.5 11.667 14.1666V15.8333C11.667 17.5 12.5003 18.3333 14.167 18.3333Z"
          strokeWidth="1.5"
          strokeMiterlimit="10"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
        <path
          d="M4.16699 18.3333H5.83366C7.50032 18.3333 8.33366 17.5 8.33366 15.8333V14.1666C8.33366 12.5 7.50032 11.6666 5.83366 11.6666H4.16699C2.50033 11.6666 1.66699 12.5 1.66699 14.1666V15.8333C1.66699 17.5 2.50033 18.3333 4.16699 18.3333Z"
          strokeWidth="1.5"
          strokeMiterlimit="10"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
      </g>
      <defs>
        <clipPath id="clip0_407_6412">
          <rect width="20" height="20" fill="white" />
        </clipPath>
      </defs>
    </svg>
  );
}

function SearchIcon({ isActive }: { isActive: boolean }) {
  return (
    <svg
      width="21"
      height="21"
      viewBox="0 0 21 21"
      xmlns="http://www.w3.org/2000/svg"
      className={classNames(isActive ? "fill-main" : "fill-text")}
    >
      <path
        fillRule="evenodd"
        clipRule="evenodd"
        d="M15.6431 14.1474L19.8645 18.3747C20.053 18.5844 20.0437 18.9055 19.8434 19.1039L19.1047 19.8437C19.0056 19.9437 18.8707 20 18.73 20C18.5893 20 18.4544 19.9437 18.3553 19.8437L14.1339 15.6164C14.0172 15.4994 13.9112 15.372 13.8173 15.2359L13.0258 14.1791C11.7162 15.2263 10.0898 15.7965 8.41388 15.796C4.96034 15.808 1.95934 13.4224 1.18757 10.0515C0.415791 6.68058 2.07921 3.22404 5.19304 1.72824C8.30686 0.232444 12.0401 1.0966 14.1825 3.8091C16.3249 6.5216 16.3047 10.3585 14.1339 13.0483L15.1893 13.7775C15.3541 13.8831 15.5063 14.0072 15.6431 14.1474ZM3.13727 8.39798C3.13727 11.3163 5.49976 13.6821 8.41405 13.6821C9.81354 13.6821 11.1557 13.1254 12.1453 12.1344C13.1349 11.1435 13.6908 9.79943 13.6908 8.39798C13.6908 5.47963 11.3283 3.11384 8.41405 3.11384C5.49976 3.11384 3.13727 5.47963 3.13727 8.39798Z"
      />
      <path
        d="M19.8645 18.3747L20.0507 18.2073L20.0414 18.1981L19.8645 18.3747ZM15.6431 14.1474L15.4641 14.322L15.4662 14.324L15.6431 14.1474ZM19.8434 19.1039L19.6675 18.9263L19.6665 18.9273L19.8434 19.1039ZM19.1047 19.8437L18.9277 19.667L18.927 19.6678L19.1047 19.8437ZM18.3553 19.8437L18.533 19.6678L18.5322 19.667L18.3553 19.8437ZM14.1339 15.6164L13.9569 15.793L13.957 15.793L14.1339 15.6164ZM13.8173 15.2359L14.0233 15.0939L14.0174 15.0861L13.8173 15.2359ZM13.0258 14.1791L13.2259 14.0292L13.0712 13.8227L12.8697 13.9838L13.0258 14.1791ZM8.41388 15.796L8.41395 15.546L8.41301 15.546L8.41388 15.796ZM1.18757 10.0515L0.943872 10.1073L1.18757 10.0515ZM5.19304 1.72824L5.08478 1.50289L5.19304 1.72824ZM14.1825 3.8091L13.9863 3.96405L14.1825 3.8091ZM14.1339 13.0483L13.9394 12.8913L13.7702 13.1009L13.9918 13.254L14.1339 13.0483ZM15.1893 13.7775L15.0471 13.9833L15.0544 13.988L15.1893 13.7775ZM12.1453 12.1344L11.9684 11.9578L12.1453 12.1344ZM20.0414 18.1981L15.82 13.9707L15.4662 14.324L19.6876 18.5514L20.0414 18.1981ZM20.0193 19.2815C20.3144 18.9892 20.3281 18.5165 20.0504 18.2076L19.6786 18.5418C19.778 18.6524 19.773 18.8217 19.6675 18.9263L20.0193 19.2815ZM19.2815 20.0203L20.0203 19.2806L19.6665 18.9273L18.9278 19.667L19.2815 20.0203ZM18.73 20.25C18.9375 20.25 19.1363 20.167 19.2823 20.0196L18.927 19.6678C18.8749 19.7204 18.8039 19.75 18.73 19.75V20.25ZM18.1777 20.0196C18.3237 20.167 18.5225 20.25 18.73 20.25V19.75C18.6561 19.75 18.5851 19.7204 18.533 19.6678L18.1777 20.0196ZM13.957 15.793L18.1784 20.0203L18.5322 19.667L14.3108 15.4397L13.957 15.793ZM13.6115 15.3779C13.7139 15.5264 13.8296 15.6653 13.9569 15.793L14.3109 15.4398C14.2048 15.3334 14.1084 15.2177 14.0231 15.094L13.6115 15.3779ZM12.8257 14.329L13.6172 15.3858L14.0174 15.0861L13.2259 14.0292L12.8257 14.329ZM8.41381 16.046C10.1466 16.0465 11.828 15.457 13.1819 14.3743L12.8697 13.9838C11.6043 14.9957 10.0331 15.5465 8.41395 15.546L8.41381 16.046ZM0.943872 10.1073C1.74169 13.5919 4.84408 16.0585 8.41475 16.046L8.41301 15.546C5.0766 15.5576 2.177 13.2529 1.43126 9.9957L0.943872 10.1073ZM5.08478 1.50289C1.86552 3.04934 0.146071 6.62271 0.943872 10.1073L1.43126 9.9957C0.68551 6.73846 2.2929 3.39874 5.30129 1.95359L5.08478 1.50289ZM14.3786 3.65414C12.1638 0.849918 8.30415 -0.0436033 5.08478 1.50289L5.30129 1.95359C8.30957 0.508492 11.9163 1.34328 13.9863 3.96405L14.3786 3.65414ZM14.3285 13.2053C16.5726 10.4247 16.5934 6.45826 14.3786 3.65414L13.9863 3.96405C16.0563 6.58494 16.0368 10.2924 13.9394 12.8913L14.3285 13.2053ZM15.3314 13.5718L14.276 12.8426L13.9918 13.254L15.0472 13.9832L15.3314 13.5718ZM15.822 13.9728C15.672 13.8191 15.505 13.6829 15.3242 13.567L15.0544 13.988C15.2032 14.0834 15.3407 14.1954 15.4641 14.322L15.822 13.9728ZM8.41405 13.4321C5.63816 13.4321 3.38727 11.1786 3.38727 8.39798H2.88727C2.88727 11.4541 5.36136 13.9321 8.41405 13.9321V13.4321ZM11.9684 11.9578C11.0257 12.9018 9.74712 13.4321 8.41405 13.4321V13.9321C9.87996 13.9321 11.2858 13.349 12.3222 12.3111L11.9684 11.9578ZM13.4408 8.39798C13.4408 9.73323 12.9111 11.0137 11.9684 11.9578L12.3222 12.3111C13.3586 11.2732 13.9408 9.86562 13.9408 8.39798H13.4408ZM8.41405 3.36384C11.1899 3.36384 13.4408 5.61738 13.4408 8.39798H13.9408C13.9408 5.34189 11.4667 2.86384 8.41405 2.86384V3.36384ZM3.38727 8.39798C3.38727 5.61738 5.63816 3.36384 8.41405 3.36384V2.86384C5.36136 2.86384 2.88727 5.34189 2.88727 8.39798H3.38727Z"
        fill="white"
      />
    </svg>
  );
}

function FavoritesIcon({ isActive }: { isActive: boolean }) {
  return (
    <svg
      width="20"
      height="18"
      viewBox="0 0 20 18"
      className={classNames(
        isActive ? "stroke-main fill-white" : "stroke-text fill-white"
      )}
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fillRule="evenodd"
        clipRule="evenodd"
        d="M9.99384 2.91615C8.19442 0.819134 5.19377 0.255042 2.93923 2.17528C0.68468 4.09552 0.367271 7.30607 2.13778 9.57714C3.60984 11.4654 8.06479 15.4478 9.52489 16.7368C9.68824 16.881 9.76992 16.9531 9.86519 16.9815C9.94834 17.0062 10.0393 17.0062 10.1225 16.9815C10.2178 16.9531 10.2994 16.881 10.4628 16.7368C11.9229 15.4478 16.3778 11.4654 17.8499 9.57714C19.6204 7.30607 19.3417 4.07532 17.0484 2.17528C14.7551 0.275241 11.7933 0.819134 9.99384 2.91615Z"
        strokeWidth="1.5"
        strokeLinecap="round"
        strokeLinejoin="round"
      />
    </svg>
  );
}

function BasketIcon() {
  return (
    <>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="20"
        height="18"
        viewBox="0 0 20 18"
        fill="none"
      >
        <path
          d="M1.30078 1H1.9071C2.92772 1 3.78462 1.7685 3.8953 2.78311L4.70626 10.2169C4.81694 11.2315 5.67384 12 6.69447 12H15.3468C16.261 12 17.0589 11.3801 17.2848 10.4942L18.6647 5.08311C18.9872 3.81854 18.0318 2.58889 16.7267 2.58889H4.90078M4.92554 15.6249H5.67554M4.92554 16.3749H5.67554M15.9255 15.6249H16.6755M15.9255 16.3749H16.6755M6.30078 16C6.30078 16.5523 5.85307 17 5.30078 17C4.7485 17 4.30078 16.5523 4.30078 16C4.30078 15.4477 4.7485 15 5.30078 15C5.85307 15 6.30078 15.4477 6.30078 16ZM17.3008 16C17.3008 16.5523 16.8531 17 16.3008 17C15.7485 17 15.3008 16.5523 15.3008 16C15.3008 15.4477 15.7485 15 16.3008 15C16.8531 15 17.3008 15.4477 17.3008 16Z"
          stroke="#2B2A29"
          stroke-width="1.5"
          stroke-linecap="round"
        />
      </svg>
      <BasketSidebar isMobile={true} />
    </>
  );
}

export default FooterMobileNavigation;
